(()=>{var e={};e.id=193,e.ids=[193],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},51269:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>d,routeModule:()=>h,tree:()=>c}),a(93468),a(53871),a(35866);var s=a(23191),r=a(88716),n=a(37922),i=a.n(n),o=a(95231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);a.d(t,l);let c=["",{children:["notifications",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,93468)),"E:\\EEMS-Front\\src\\app\\notifications\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,53871)),"E:\\EEMS-Front\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"]}],d=["E:\\EEMS-Front\\src\\app\\notifications\\page.tsx"],u="/notifications/page",m={require:a,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/notifications/page",pathname:"/notifications",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},45135:(e,t,a)=>{Promise.resolve().then(a.bind(a,36130))},36130:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var s=a(10326),r=a(17577),n=a(62757),i=a(18069),o=a(41190),l=a(29752),c=a(19381),d=a(59675);function u(){let[e,t]=(0,r.useState)([]),[a,u]=(0,r.useState)(""),[m,h]=(0,r.useState)(!0),[x,p]=(0,r.useState)(null),f=async()=>{try{h(!0),p(null);let e=await (0,i.Mf)();t(e),e.length>0&&!a&&u(e[0].id)}catch(e){console.error("Error loading simulators:",e),p(e instanceof Error?e.message:"Failed to load simulators")}finally{h(!1)}},g=e.find(e=>e.id===a);return m?s.jsx("div",{className:"min-h-screen bg-slate-950 p-6",children:s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsx(l.Zb,{children:(0,s.jsxs)(l.aY,{className:"p-8 text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),s.jsx("p",{className:"text-slate-400",children:"Loading simulators..."})]})})})}):x?s.jsx("div",{className:"min-h-screen bg-slate-950 p-6",children:s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsx(l.Zb,{children:(0,s.jsxs)(l.aY,{className:"p-8 text-center",children:[s.jsx(c.Z,{className:"h-12 w-12 text-danger mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Error Loading Simulators"}),s.jsx("p",{className:"text-slate-400 mb-4",children:x}),s.jsx("button",{onClick:f,className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 transition-colors",children:"Try Again"})]})})})}):0===e.length?s.jsx("div",{className:"min-h-screen bg-slate-950 p-6",children:s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsx(l.Zb,{children:(0,s.jsxs)(l.aY,{className:"p-8 text-center",children:[s.jsx(d.Z,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"No Simulators Available"}),s.jsx("p",{className:"text-slate-400",children:"You need to create at least one simulator before setting up notifications."})]})})})}):s.jsx("div",{className:"min-h-screen bg-slate-950 p-6",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,s.jsxs)("header",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[s.jsx(d.Z,{className:"h-8 w-8 text-primary"}),(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-white",children:"WhatsApp Notifications"}),s.jsx("p",{className:"text-slate-400",children:"Manage notification triggers for your energy management simulators"})]})]}),e.length>1&&(0,s.jsxs)(l.Zb,{children:[s.jsx(l.Ol,{children:s.jsx("h3",{className:"text-lg font-semibold text-white",children:"Select Simulator"})}),s.jsx(l.aY,{children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[s.jsx("label",{htmlFor:"simulator-select",className:"text-sm font-medium text-slate-300 min-w-0",children:"Simulator:"}),s.jsx(o.Ph,{id:"simulator-select",value:a,onChange:e=>u(e.target.value),className:"flex-1 max-w-md",children:e.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.name," (Target: ",e.target_kwh," kWh)"]},e.id))})]})})]})]}),g&&s.jsx(n.fn,{simulatorId:g.id,simulatorName:g.name})]})})}},91664:(e,t,a)=>{"use strict";a.d(t,{z:()=>o});var s=a(10326),r=a(17577),n=a(41135);let i={variant:{primary:"bg-primary text-white shadow-sm hover:bg-cyan-600 hover:shadow-md active:scale-95",secondary:"border border-slate-700 bg-transparent text-slate-200 hover:bg-slate-800 hover:border-slate-600",ghost:"hover:bg-slate-800/50 text-slate-300 hover:text-white",danger:"bg-danger text-white shadow-sm hover:bg-red-600 hover:shadow-md active:scale-95",success:"bg-success text-white shadow-sm hover:bg-green-600 hover:shadow-md active:scale-95"},size:{sm:"px-3 py-1.5 text-xs min-h-[36px]",md:"px-4 py-2 text-sm min-h-[44px]",lg:"px-6 py-3 text-base min-h-[48px]"}},o=(0,r.forwardRef)(({className:e,variant:t="primary",size:a="md",isLoading:r,children:o,disabled:l,...c},d)=>(0,s.jsxs)("button",{className:(0,n.Z)("inline-flex items-center justify-center gap-2 rounded-md font-semibold transition-all duration-150","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 focus-visible:ring-offset-slate-950","disabled:pointer-events-none disabled:opacity-50",i.variant[t],i.size[a],e),ref:d,disabled:l||r,...c,children:[r&&(0,s.jsxs)("svg",{className:"h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:r?"opacity-70":"",children:o})]}));o.displayName="Button"},4753:(e,t,a)=>{"use strict";a.d(t,{Dr:()=>o,HM:()=>u,Oz:()=>d,Qu:()=>h,tQ:()=>x,w:()=>m,wC:()=>c,wE:()=>l});let s=[{name:"NEXT_PUBLIC_BACKEND_TOKEN",value:"01121000099"},{name:"NEXT_PUBLIC_BACKEND_WRITE_TOKEN",value:process.env.NEXT_PUBLIC_BACKEND_WRITE_TOKEN},{name:"NEXT_PUBLIC_BACKEND_KEY",value:process.env.NEXT_PUBLIC_BACKEND_KEY},{name:"NEXT_PUBLIC_BACKEND_API_KEY",value:process.env.NEXT_PUBLIC_BACKEND_API_KEY}],r=null,n=!1;function i(){for(let e of s)if(e.value)return{name:e.name,value:e.value};return null}function o(){return i()?.value??""}function l(){return i()?.name??null}function c(){return n&&!!r}function d(e,t){r=e.trim()||null,n=!!(t?.persist&&r)}function u(){r=null,n=!1}function m(){return r||o()}function h(){return m().length>0}function x(){return o().length>0}},18069:(e,t,a)=>{"use strict";a.d(t,{Aq:()=>b,Bj:()=>x,CT:()=>r,LK:()=>h,M8:()=>v,Mf:()=>p,QY:()=>w,aj:()=>g,b0:()=>m,he:()=>E,ji:()=>f,lA:()=>y});var s=a(4753);let r="/api/bridge",n=new Set([429,500,502,503,504]);class i extends Error{constructor(e,t,a,s){super(e),this.status=t,this.code=a,this.details=s}}function o(e){if(!r)throw new i("Backend base URL is not configured.",0);return e.startsWith("http")?e:`${r}${e}`}async function l(e){let t=await e.text();if(t)try{return JSON.parse(t)}catch(t){throw new i(`Invalid JSON response: ${t.message}`,e.status)}}async function c(e){let t;try{t=await e.clone().json()}catch{}if(!t)try{let t=await e.text();if(t)return new i(t,e.status)}catch{}let a=t?.error?.message??t?.message??e.statusText??`Request failed with status ${e.status}`,s=t?.error?.code,r=t?.error?.details;if(t&&t.detail){r=t.detail;try{if(Array.isArray(t.detail)){let e=t.detail.map(e=>e?.msg||e?.detail||"Validation error").filter(Boolean);e.length>0&&(a=e.join("; "))}else"string"==typeof t.detail&&(a=t.detail)}catch{}}return new i(a,e.status,s,r)}function d(e){return new Promise(t=>setTimeout(t,e))}async function u(e,t,a={}){let s=o(e);s=`http://localhost${s}`;let r=a.retryDelays??[],u=0,m=new Headers(t?.headers);m.set("Accept","application/json");let h={...t,headers:m};for(;;)try{let e=await fetch(s,h);if(!e.ok){var x;let t=await c(e);if(x=e.status,n.has(x)&&u<r.length){await d(r[u++]);continue}throw t}if(204===e.status)return;return await l(e)}catch(e){if(e instanceof i)throw e;if(u<r.length){await d(r[u++]);continue}throw e}}function m(e){let t=new Headers(e?.headers);t.set("Content-Type","application/json");let a=(0,s.w)();return a?t.set("x-api-key",a):t.delete("x-api-key"),{...e,headers:t}}async function h(e,t){try{return await u(e,t)}catch(a){if(!(a instanceof i))return await u(e,t,{retryDelays:[500]});throw a}}function x(e){return o(e)}async function p(){let e=await h("/api/v1/simulators");return Array.isArray(e)?e:e.data??[]}async function f(e){let t=await u("/api/v1/simulators",m({method:"POST",body:JSON.stringify(e)}),{retryDelays:[500,1500,3500]});return"data"in t?t.data:t}async function g(e){console.log("deleteSimulator called with id:",e);try{await u(`/api/v1/simulators/${e}`,m({method:"DELETE"}),{retryDelays:[500,1500]}),console.log("deleteSimulator successful for id:",e)}catch(t){throw console.error("deleteSimulator error for id:",e,t),t}}async function y(e){return await h(`/api/v1/blocks/latest?simulator_id=${encodeURIComponent(e)}`)}async function w(e,t=10){let a=await h(`/api/v1/blocks/history?simulator_id=${encodeURIComponent(e)}&limit=${t}`);return Array.isArray(a)?a:a.data??[]}async function v(e){await u("/api/v1/readings:ingest",m({method:"POST",body:JSON.stringify(e)}),{retryDelays:[500,1500,3500]})}async function b(e){try{let t=new Date().toISOString();await u(`/api/v1/readings?simulator_id=${encodeURIComponent(e)}&before=${encodeURIComponent(t)}`,m({method:"DELETE"}),{retryDelays:[500,1500]})}catch(t){try{await u(`/api/v1/simulators/${encodeURIComponent(e)}/readings`,m({method:"DELETE"}),{retryDelays:[500,1500]})}catch(e){console.warn("Failed to delete future readings from backend:",t,e)}}}async function E(e){try{let t=await y(e);if(t.chart_bins?.points&&t.chart_bins.points.length>0){let e=new Date(t.block_start_local),a=t.chart_bins.bin_seconds||30,s=t.chart_bins.points.length;return new Date(e.getTime()+s*a*1e3).toISOString()}return null}catch(e){return console.warn("Failed to fetch last reading timestamp:",e),null}}},93468:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>i,__esModule:()=>n,default:()=>o});var s=a(68570);let r=(0,s.createProxy)(String.raw`E:\EEMS-Front\src\app\notifications\page.tsx`),{__esModule:n,$$typeof:i}=r;r.default;let o=(0,s.createProxy)(String.raw`E:\EEMS-Front\src\app\notifications\page.tsx#default`)},42553:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var s=a(17577);let r=s.forwardRef(function({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"}))})}};var t=require("../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[948,808,987,757],()=>a(51269));module.exports=s})();