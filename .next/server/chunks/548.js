"use strict";exports.id=548,exports.ids=[548],exports.modules={2898:(e,t,s)=>{s.d(t,{l:()=>m});var a=s(326),r=s(7577);let l=r.forwardRef(function({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z"}))});var n=s(2505);let i=r.forwardRef(function({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"}))});var d=s(1135);let c=new Intl.NumberFormat(void 0,{maximumFractionDigits:0}),o=new Intl.DateTimeFormat(void 0,{hour:"2-digit",minute:"2-digit",second:"2-digit"});function m({baseKw:e,onBaseKwChange:t,volatility:s,onVolatilityChange:r,isRunning:m,onStart:u,onStop:x,sentCount:h,lastSentAt:p,disabled:g,disabledReason:f}){let b=p?o.format(new Date(p)):"—";return(0,a.jsxs)("article",{className:"flex flex-col gap-6 rounded-2xl border border-slate-800 bg-slate-900/60 p-6",children:[(0,a.jsxs)("header",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-white",children:"Auto mode"}),a.jsx("p",{className:"text-sm text-slate-400",children:"Emit one tick every second with gaussian noise. Fast-forward mode advances simulated time by 30 seconds per real second."})]}),a.jsx(l,{className:"h-8 w-8 text-cyan-500","aria-hidden":"true"})]}),(0,a.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,a.jsxs)("label",{className:"flex flex-col gap-2 text-sm",children:[a.jsx("span",{className:"text-xs uppercase tracking-[0.2em] text-slate-500",children:"Base kW"}),a.jsx("input",{type:"number",min:0,step:1,value:e,onChange:e=>{t(Number(e.target.value))},className:"w-full rounded-md border border-slate-800 bg-slate-950/60 px-3 py-2 text-sm text-white focus:border-cyan-500 focus:outline-none"})]}),(0,a.jsxs)("label",{className:"flex flex-col gap-2 text-sm",children:[a.jsx("span",{className:"text-xs uppercase tracking-[0.2em] text-slate-500",children:"Volatility %"}),a.jsx("input",{type:"number",min:0,max:100,step:1,value:s,onChange:e=>{r(Math.max(0,Math.min(100,Number(e.target.value))))},className:"w-full rounded-md border border-slate-800 bg-slate-950/60 px-3 py-2 text-sm text-white focus:border-cyan-500 focus:outline-none"})]})]}),(0,a.jsxs)("div",{className:"rounded-lg border border-slate-800 bg-slate-950/60 p-4 text-xs text-slate-400",children:[(0,a.jsxs)("p",{children:["Next tick interval: ",a.jsx("span",{className:"font-semibold text-slate-200",children:"1 second"})]}),(0,a.jsxs)("p",{className:"mt-1",children:["Expected power window: ",a.jsx("span",{className:"font-semibold text-slate-200",children:c.format(Math.max(0,Math.round(e*(1-s/100))))})," – "," ",a.jsx("span",{className:"font-semibold text-slate-200",children:c.format(Math.round(e*(1+s/100)))})," kW"]})]}),a.jsx("button",{type:"button",onClick:m?x:u,disabled:g,className:(0,d.Z)("inline-flex items-center justify-center gap-2 rounded-md px-4 py-2 text-sm font-semibold transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",g?"cursor-not-allowed bg-slate-800/60 text-slate-500":m?"bg-danger/80 text-white hover:bg-danger":"bg-primary text-primary-foreground hover:bg-cyan-600"),children:m?(0,a.jsxs)(a.Fragment,{children:[a.jsx(n.Z,{className:"h-4 w-4","aria-hidden":"true"})," Stop auto run"]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(i,{className:"h-4 w-4","aria-hidden":"true"})," Start auto run"]})}),g&&f?a.jsx("p",{className:"text-xs text-warning",children:f}):null,(0,a.jsxs)("dl",{className:"grid grid-cols-2 gap-4 rounded-lg border border-slate-800 bg-slate-950/60 p-4 text-xs text-slate-400",children:[(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"uppercase tracking-[0.2em] text-slate-600",children:"Ticks sent"}),a.jsx("dd",{className:"mt-1 text-sm text-slate-200",children:h})]}),(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"uppercase tracking-[0.2em] text-slate-600",children:"Last tick"}),a.jsx("dd",{className:"mt-1 text-sm text-slate-200",children:b})]})]})]})}},4053:(e,t,s)=>{s.d(t,{x:()=>c});var a=s(326),r=s(7577);let l=r.forwardRef(function({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.59 14.37a6 6 0 0 1-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 0 0 6.16-12.12A14.98 14.98 0 0 0 9.631 8.41m5.96 5.96a14.926 14.926 0 0 1-5.841 2.58m-.119-8.54a6 6 0 0 0-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 0 0-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 0 1-2.448-2.448 14.9 14.9 0 0 1 .06-.312m-2.24 2.39a4.493 4.493 0 0 0-1.757 4.306 4.493 4.493 0 0 0 4.306-1.758M16.5 9a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"}))});var n=s(2505),i=s(1135);let d=new Intl.DateTimeFormat(void 0,{hour:"2-digit",minute:"2-digit",second:"2-digit"});function c({sliderValue:e,onSliderChange:t,maxKw:s,onMaxKwChange:r,isRunning:c,onStart:o,onStop:m,sentCount:u,lastSentAt:x,disabled:h,disabledReason:p}){let g=Math.max(0,e*s),f=x?d.format(new Date(x)):"—";return(0,a.jsxs)("article",{className:"flex flex-col gap-6 rounded-2xl border border-slate-800 bg-slate-900/60 p-6",children:[(0,a.jsxs)("header",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-white",children:"Manual fast-forward"}),a.jsx("p",{className:"text-sm text-slate-400",children:"Emit one tick per second using the selected power multiplier."})]}),a.jsx(l,{className:"h-8 w-8 text-purple-400","aria-hidden":"true"})]}),(0,a.jsxs)("div",{className:"grid gap-4 sm:grid-cols-[minmax(0,2fr)_1fr]",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsxs)("label",{className:"flex flex-col gap-2 text-sm",children:[a.jsx("span",{className:"text-xs uppercase tracking-[0.2em] text-slate-500",children:"Adjust load multiplier"}),a.jsx("input",{type:"range",min:0,max:1,step:.01,value:e,onChange:e=>{t(Number(e.target.value))},className:"w-full"}),(0,a.jsxs)("span",{className:"text-xs text-slate-400",children:["FAST-FORWARD x30 — Multiplier ",(100*e).toFixed(0),"%"]})]}),(0,a.jsxs)("label",{className:"flex flex-col gap-2 text-sm",children:[a.jsx("span",{className:"text-xs uppercase tracking-[0.2em] text-slate-500",children:"Max power (kW)"}),a.jsx("input",{type:"number",min:0,step:5,value:s,onChange:e=>{r(Math.max(0,Number(e.target.value)))},className:"w-full rounded-md border border-slate-800 bg-slate-950/60 px-3 py-2 text-sm text-white focus:border-purple-400 focus:outline-none"})]})]}),(0,a.jsxs)("div",{className:"rounded-lg border border-slate-800 bg-slate-950/60 p-4 text-xs text-slate-400",children:[(0,a.jsxs)("p",{children:["Current output: ",a.jsx("span",{className:"font-semibold text-slate-200",children:g.toFixed(1)})," kW"]}),(0,a.jsxs)("p",{className:"mt-1",children:["Ticks are emitted every ",a.jsx("span",{className:"font-semibold text-slate-200",children:"1 second"})," with ",a.jsx("span",{className:"font-semibold text-slate-200",children:"sample_seconds=30"}),". Fast-forward mode advances simulated time by 30 seconds per real second."]})]})]}),a.jsx("button",{type:"button",onClick:c?m:o,disabled:h,className:(0,i.Z)("inline-flex items-center justify-center gap-2 rounded-md px-4 py-2 text-sm font-semibold transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",h?"cursor-not-allowed bg-slate-800/60 text-slate-500":c?"bg-danger/80 text-white hover:bg-danger":"bg-primary text-primary-foreground hover:bg-cyan-600"),children:c?(0,a.jsxs)(a.Fragment,{children:[a.jsx(n.Z,{className:"h-4 w-4","aria-hidden":"true"})," Stop manual run"]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(l,{className:"h-4 w-4","aria-hidden":"true"})," Start manual run"]})}),h&&p?a.jsx("p",{className:"text-xs text-warning",children:p}):null,(0,a.jsxs)("dl",{className:"grid grid-cols-2 gap-4 rounded-lg border border-slate-800 bg-slate-950/60 p-4 text-xs text-slate-400",children:[(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"uppercase tracking-[0.2em] text-slate-600",children:"Ticks sent"}),a.jsx("dd",{className:"mt-1 text-sm text-slate-200",children:u})]}),(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"uppercase tracking-[0.2em] text-slate-600",children:"Last tick"}),a.jsx("dd",{className:"mt-1 text-sm text-slate-200",children:f})]})]})]})}},902:(e,t,s)=>{s.d(t,{V:()=>i,o:()=>d});var a=s(7577),r=s(8069),l=s(1004);function n({simulatorId:e,intervalMs:t,mode:s,getTick:n,fastForwardEnabled:i=!1,onTickSent:d}){let{push:c}=(0,l.p)(),[o,m]=(0,a.useState)(!1),[u,x]=(0,a.useState)(0),[h,p]=(0,a.useState)(void 0),g=(0,a.useRef)(null),f=(0,a.useRef)(0),b=(0,a.useRef)(()=>{}),w=(0,a.useRef)(null),j=(0,a.useCallback)(()=>{g.current&&(clearInterval(g.current),g.current=null),m(!1),w.current=null},[]),v=(0,a.useCallback)(async()=>{if(!e)return;let a=n();if(i){let e=new Date;if(w.current){let e=t/1e3*30;w.current=new Date(w.current.getTime()+1e3*e)}else w.current=new Date(e);a={...a,device_ts:w.current.toISOString()}}try{await (0,r.M8)({simulator_id:e,mode:s,ticks:[a]}),f.current=0,x(e=>e+1),p(a.device_ts),d?.(a);let t=`recent_ticks_${e}`,l=JSON.parse(localStorage.getItem(t)||"[]");l.push({ts:Date.now(),...a}),l.length>180&&l.shift(),localStorage.setItem(t,JSON.stringify(l))}catch(t){f.current+=1;let e=t instanceof Error?t.message:"Failed to deliver reading";1===f.current&&c({title:"Reading delivery failed",description:e,variant:"error"}),f.current>=3&&(j(),c({title:"Emitter paused",description:`Stopped ${s} emitter after repeated failures.`,variant:"error",action:{label:"Retry now",onClick:()=>b.current()}}))}},[i,n,t,s,d,c,e,j]);return{isRunning:o,sentCount:u,lastSentAt:h,start:(0,a.useCallback)(async()=>{if(!e){c({title:"No simulator selected",description:"Create or pick a simulator before sending readings.",variant:"error"});return}if(!g.current){(0,r.Aq)(e).catch(e=>{console.warn("Failed to delete future readings:",e)});try{let t=await (0,r.he)(e);t&&i?w.current=new Date(t):i&&(w.current=new Date)}catch(e){console.warn("Failed to get last reading timestamp, starting from current time:",e),i&&(w.current=new Date)}f.current=0,m(!0),v(),g.current=setInterval(()=>{v()},t)}},[i,t,c,v,e]),stop:j}}function i(e,t,s,r=!1,l){return n({simulatorId:e,intervalMs:2e3,mode:"auto",getTick:(0,a.useCallback)(()=>({power_kw:Number(Math.max(0,t*(1+Math.max(0,Math.min(s,100))/100*(2*Math.random()-1))).toFixed(3)),sample_seconds:30,device_ts:new Date().toISOString()}),[t,s]),fastForwardEnabled:r,onTickSent:l})}function d(e,t,s=!1,r){return n({simulatorId:e,intervalMs:2e3,mode:"manual",getTick:(0,a.useCallback)(()=>({power_kw:Number(Math.max(0,t()).toFixed(3)),sample_seconds:30,device_ts:new Date().toISOString()}),[t]),fastForwardEnabled:s,onTickSent:r})}},2505:(e,t,s)=>{s.d(t,{Z:()=>r});var a=s(7577);let r=a.forwardRef(function({title:e,titleId:t,...s},r){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?a.createElement("title",{id:t},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 0 1 7.5 5.25h9a2.25 2.25 0 0 1 2.25 2.25v9a2.25 2.25 0 0 1-2.25 2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-9Z"}))})}};