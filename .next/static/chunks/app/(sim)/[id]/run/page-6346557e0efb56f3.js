(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[998],{71536:function(e,t,n){Promise.resolve().then(n.bind(n,73189))},87138:function(e,t,n){"use strict";n.d(t,{default:function(){return s.a}});var r=n(231),s=n.n(r)},20357:function(e,t,n){"use strict";var r,s;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(s=n.g.process)?void 0:s.env)?n.g.process:n(88081)},88081:function(e){!function(){var t={229:function(e){var t,n,r,s=e.exports={};function a(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function l(e){if(t===setTimeout)return setTimeout(e,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:a}catch(e){t=a}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(e){n=i}}();var o=[],c=!1,u=-1;function d(){c&&r&&(c=!1,r.length?o=r.concat(o):u=-1,o.length&&m())}function m(){if(!c){var e=l(d);c=!0;for(var t=o.length;t;){for(r=o,o=[];++u<t;)r&&r[u].run();u=-1,t=o.length}r=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function x(e,t){this.fun=e,this.array=t}function f(){}s.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];o.push(new x(e,t)),1!==o.length||c||l(m)},x.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=f,s.addListener=f,s.once=f,s.off=f,s.removeListener=f,s.removeAllListeners=f,s.emit=f,s.prependListener=f,s.prependOnceListener=f,s.listeners=function(e){return[]},s.binding=function(e){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw Error("process.chdir is not supported")},s.umask=function(){return 0}}},n={};function r(e){var s=n[e];if(void 0!==s)return s.exports;var a=n[e]={exports:{}},i=!0;try{t[e](a,a.exports,r),i=!1}finally{i&&delete n[e]}return a.exports}r.ab="//";var s=r(229);e.exports=s}()},73189:function(e,t,n){"use strict";n.d(t,{SimulatorRunContent:function(){return b}});var r=n(57437),s=n(2265),a=n(87138);let i=s.forwardRef(function(e,t){let{title:n,titleId:r,...a}=e;return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},a),n?s.createElement("title",{id:r},n):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z"}))}),l=s.forwardRef(function(e,t){let{title:n,titleId:r,...a}=e;return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},a),n?s.createElement("title",{id:r},n):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 0 1 7.5 5.25h9a2.25 2.25 0 0 1 2.25 2.25v9a2.25 2.25 0 0 1-2.25 2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-9Z"}))}),o=s.forwardRef(function(e,t){let{title:n,titleId:r,...a}=e;return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},a),n?s.createElement("title",{id:r},n):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"}))});var c=n(44839);let u=new Intl.NumberFormat(void 0,{maximumFractionDigits:0}),d=new Intl.DateTimeFormat(void 0,{hour:"2-digit",minute:"2-digit",second:"2-digit"});function m(e){let{baseKw:t,onBaseKwChange:n,volatility:s,onVolatilityChange:a,isRunning:m,onStart:x,onStop:f,sentCount:h,lastSentAt:p,disabled:g,disabledReason:v}=e,b=p?d.format(new Date(p)):"—";return(0,r.jsxs)("article",{className:"flex flex-col gap-6 rounded-2xl border border-slate-800 bg-slate-900/60 p-6",children:[(0,r.jsxs)("header",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Auto mode"}),(0,r.jsx)("p",{className:"text-sm text-slate-400",children:"Emit one tick every 15 seconds with gaussian noise."})]}),(0,r.jsx)(i,{className:"h-8 w-8 text-cyan-500","aria-hidden":"true"})]}),(0,r.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,r.jsxs)("label",{className:"flex flex-col gap-2 text-sm",children:[(0,r.jsx)("span",{className:"text-xs uppercase tracking-[0.2em] text-slate-500",children:"Base kW"}),(0,r.jsx)("input",{type:"number",min:0,step:1,value:t,onChange:e=>{n(Number(e.target.value))},className:"w-full rounded-md border border-slate-800 bg-slate-950/60 px-3 py-2 text-sm text-white focus:border-cyan-500 focus:outline-none"})]}),(0,r.jsxs)("label",{className:"flex flex-col gap-2 text-sm",children:[(0,r.jsx)("span",{className:"text-xs uppercase tracking-[0.2em] text-slate-500",children:"Volatility %"}),(0,r.jsx)("input",{type:"number",min:0,max:100,step:1,value:s,onChange:e=>{a(Math.max(0,Math.min(100,Number(e.target.value))))},className:"w-full rounded-md border border-slate-800 bg-slate-950/60 px-3 py-2 text-sm text-white focus:border-cyan-500 focus:outline-none"})]})]}),(0,r.jsxs)("div",{className:"rounded-lg border border-slate-800 bg-slate-950/60 p-4 text-xs text-slate-400",children:[(0,r.jsxs)("p",{children:["Next tick interval: ",(0,r.jsx)("span",{className:"font-semibold text-slate-200",children:"15 seconds"})]}),(0,r.jsxs)("p",{className:"mt-1",children:["Expected power window: ",(0,r.jsx)("span",{className:"font-semibold text-slate-200",children:u.format(Math.max(0,Math.round(t*(1-s/100))))})," – "," ",(0,r.jsx)("span",{className:"font-semibold text-slate-200",children:u.format(Math.round(t*(1+s/100)))})," kW"]})]}),(0,r.jsx)("button",{type:"button",onClick:m?f:x,disabled:g,className:(0,c.Z)("inline-flex items-center justify-center gap-2 rounded-md px-4 py-2 text-sm font-semibold transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",g?"cursor-not-allowed bg-slate-800/60 text-slate-500":m?"bg-danger/80 text-white hover:bg-danger":"bg-primary text-primary-foreground hover:bg-cyan-600"),children:m?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l,{className:"h-4 w-4","aria-hidden":"true"})," Stop auto run"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o,{className:"h-4 w-4","aria-hidden":"true"})," Start auto run"]})}),g&&v?(0,r.jsx)("p",{className:"text-xs text-warning",children:v}):null,(0,r.jsxs)("dl",{className:"grid grid-cols-2 gap-4 rounded-lg border border-slate-800 bg-slate-950/60 p-4 text-xs text-slate-400",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"uppercase tracking-[0.2em] text-slate-600",children:"Ticks sent"}),(0,r.jsx)("dd",{className:"mt-1 text-sm text-slate-200",children:h})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"uppercase tracking-[0.2em] text-slate-600",children:"Last tick"}),(0,r.jsx)("dd",{className:"mt-1 text-sm text-slate-200",children:b})]})]})]})}let x=s.forwardRef(function(e,t){let{title:n,titleId:r,...a}=e;return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},a),n?s.createElement("title",{id:r},n):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.59 14.37a6 6 0 0 1-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 0 0 6.16-12.12A14.98 14.98 0 0 0 9.631 8.41m5.96 5.96a14.926 14.926 0 0 1-5.841 2.58m-.119-8.54a6 6 0 0 0-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 0 0-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 0 1-2.448-2.448 14.9 14.9 0 0 1 .06-.312m-2.24 2.39a4.493 4.493 0 0 0-1.757 4.306 4.493 4.493 0 0 0 4.306-1.758M16.5 9a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"}))}),f=new Intl.DateTimeFormat(void 0,{hour:"2-digit",minute:"2-digit",second:"2-digit"});function h(e){let{sliderValue:t,onSliderChange:n,maxKw:s,onMaxKwChange:a,isRunning:i,onStart:o,onStop:u,sentCount:d,lastSentAt:m,disabled:h,disabledReason:p}=e,g=Math.max(0,t*s),v=m?f.format(new Date(m)):"—";return(0,r.jsxs)("article",{className:"flex flex-col gap-6 rounded-2xl border border-slate-800 bg-slate-900/60 p-6",children:[(0,r.jsxs)("header",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Manual fast-forward"}),(0,r.jsx)("p",{className:"text-sm text-slate-400",children:"Emit one tick per second using the selected power multiplier."})]}),(0,r.jsx)(x,{className:"h-8 w-8 text-purple-400","aria-hidden":"true"})]}),(0,r.jsxs)("div",{className:"grid gap-4 sm:grid-cols-[minmax(0,2fr)_1fr]",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsxs)("label",{className:"flex flex-col gap-2 text-sm",children:[(0,r.jsx)("span",{className:"text-xs uppercase tracking-[0.2em] text-slate-500",children:"Adjust load multiplier"}),(0,r.jsx)("input",{type:"range",min:0,max:1,step:.01,value:t,onChange:e=>{n(Number(e.target.value))},className:"w-full"}),(0,r.jsxs)("span",{className:"text-xs text-slate-400",children:["FAST-FORWARD x15 — Multiplier ",(100*t).toFixed(0),"%"]})]}),(0,r.jsxs)("label",{className:"flex flex-col gap-2 text-sm",children:[(0,r.jsx)("span",{className:"text-xs uppercase tracking-[0.2em] text-slate-500",children:"Max power (kW)"}),(0,r.jsx)("input",{type:"number",min:0,step:5,value:s,onChange:e=>{a(Math.max(0,Number(e.target.value)))},className:"w-full rounded-md border border-slate-800 bg-slate-950/60 px-3 py-2 text-sm text-white focus:border-purple-400 focus:outline-none"})]})]}),(0,r.jsxs)("div",{className:"rounded-lg border border-slate-800 bg-slate-950/60 p-4 text-xs text-slate-400",children:[(0,r.jsxs)("p",{children:["Current output: ",(0,r.jsx)("span",{className:"font-semibold text-slate-200",children:g.toFixed(1)})," kW"]}),(0,r.jsxs)("p",{className:"mt-1",children:["Ticks are emitted every ",(0,r.jsx)("span",{className:"font-semibold text-slate-200",children:"1 second"})," with ",(0,r.jsx)("span",{className:"font-semibold text-slate-200",children:"sample_seconds=15"}),"."]})]})]}),(0,r.jsx)("button",{type:"button",onClick:i?u:o,disabled:h,className:(0,c.Z)("inline-flex items-center justify-center gap-2 rounded-md px-4 py-2 text-sm font-semibold transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",h?"cursor-not-allowed bg-slate-800/60 text-slate-500":i?"bg-danger/80 text-white hover:bg-danger":"bg-primary text-primary-foreground hover:bg-cyan-600"),children:i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l,{className:"h-4 w-4","aria-hidden":"true"})," Stop manual run"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x,{className:"h-4 w-4","aria-hidden":"true"})," Start manual run"]})}),h&&p?(0,r.jsx)("p",{className:"text-xs text-warning",children:p}):null,(0,r.jsxs)("dl",{className:"grid grid-cols-2 gap-4 rounded-lg border border-slate-800 bg-slate-950/60 p-4 text-xs text-slate-400",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"uppercase tracking-[0.2em] text-slate-600",children:"Ticks sent"}),(0,r.jsx)("dd",{className:"mt-1 text-sm text-slate-200",children:d})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"uppercase tracking-[0.2em] text-slate-600",children:"Last tick"}),(0,r.jsx)("dd",{className:"mt-1 text-sm text-slate-200",children:v})]})]})]})}var p=n(92800),g=n(46068);function v(e){let{simulatorId:t,intervalMs:n,mode:r,getTick:a}=e,{push:i}=(0,g.p)(),[l,o]=(0,s.useState)(!1),[c,u]=(0,s.useState)(0),[d,m]=(0,s.useState)(void 0),x=(0,s.useRef)(null),f=(0,s.useRef)(0),h=(0,s.useRef)(()=>{}),v=(0,s.useCallback)(()=>{x.current&&(clearInterval(x.current),x.current=null),o(!1)},[]),b=(0,s.useCallback)(async()=>{if(!t)return;let e=a();try{await (0,p.M8)({simulator_id:t,mode:r,ticks:[e]}),f.current=0,u(e=>e+1),m(new Date().toISOString());let n="recent_ticks_".concat(t),s=JSON.parse(localStorage.getItem(n)||"[]");s.push({ts:Date.now(),...e}),s.length>180&&s.shift(),localStorage.setItem(n,JSON.stringify(s))}catch(t){f.current+=1;let e=t instanceof Error?t.message:"Failed to deliver reading";1===f.current&&i({title:"Reading delivery failed",description:e,variant:"error"}),f.current>=3&&(v(),i({title:"Emitter paused",description:"Stopped ".concat(r," emitter after repeated failures."),variant:"error",action:{label:"Retry now",onClick:()=>h.current()}}))}},[a,r,i,t,v]),w=(0,s.useCallback)(()=>{if(!t){i({title:"No simulator selected",description:"Create or pick a simulator before sending readings.",variant:"error"});return}x.current||(f.current=0,o(!0),b(),x.current=setInterval(()=>{b()},n))},[n,i,b,t]);return(0,s.useEffect)(()=>{h.current=w},[w]),(0,s.useEffect)(()=>()=>{x.current&&clearInterval(x.current)},[]),{isRunning:l,sentCount:c,lastSentAt:d,start:w,stop:v}}function b(e){var t;let{simulatorId:n,simulatorName:i,targetKwh:l}=e,[o,c]=(0,s.useState)(320),[u,d]=(0,s.useState)(12),[x,f]=(0,s.useState)(.5),[p,g]=(0,s.useState)(800),b=(0,s.useMemo)(()=>x*p,[x,p]),w=v({simulatorId:n,intervalMs:1e3,mode:"auto",getTick:(0,s.useCallback)(()=>({power_kw:Number(Math.max(0,o*(1+Math.max(0,Math.min(u,100))/100*(2*Math.random()-1))).toFixed(3)),sample_seconds:30,device_ts:new Date().toISOString()}),[o,u])}),y=(t=()=>b,v({simulatorId:n,intervalMs:1e3,mode:"manual",getTick:(0,s.useCallback)(()=>({power_kw:Number(Math.max(0,t()).toFixed(3)),sample_seconds:30,device_ts:new Date().toISOString()}),[t])})),j=()=>{w.isRunning?w.stop():(y.stop(),w.start())},N=()=>{y.isRunning?y.stop():(w.stop(),y.start())};return(0,r.jsxs)("section",{className:"space-y-10",children:[(0,r.jsxs)("header",{className:"flex flex-wrap items-end justify-between gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-500",children:"Simulator controls"}),(0,r.jsx)("h1",{className:"text-3xl font-semibold text-white",children:i}),(0,r.jsx)("p",{className:"text-sm text-slate-400",children:"Configure auto and manual emitters. Only one mode can run at a time to avoid duplicate ticks."}),(0,r.jsxs)("p",{className:"text-xs text-slate-500",children:["Target block: ",l?"".concat(l," kWh"):"—"," \xb7 Timezone ","Asia/Kuala_Lumpur"]})]}),(0,r.jsx)(a.default,{href:{pathname:"/sim/[id]",query:{id:n}},className:"inline-flex items-center rounded-md border border-slate-700 px-4 py-2 text-sm font-semibold text-slate-200 transition hover:border-slate-500 hover:text-white",children:"Back to dashboard"})]}),(0,r.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,r.jsx)(m,{baseKw:o,onBaseKwChange:c,volatility:u,onVolatilityChange:d,isRunning:w.isRunning,onStart:j,onStop:j,sentCount:w.sentCount,lastSentAt:w.lastSentAt,disabled:y.isRunning,disabledReason:y.isRunning?"Manual emitter is active. Stop it before running auto mode.":void 0}),(0,r.jsx)(h,{sliderValue:x,onSliderChange:f,maxKw:p,onMaxKwChange:g,isRunning:y.isRunning,onStart:N,onStop:N,sentCount:y.sentCount,lastSentAt:y.lastSentAt,disabled:w.isRunning,disabledReason:w.isRunning?"Auto emitter is active. Stop it before running manual mode.":void 0})]}),(0,r.jsxs)("p",{className:"text-xs text-slate-500",children:["Auto mode sends gaussianised readings every 15 seconds; manual fast-forward emits every second with ",(0,r.jsx)("code",{className:"rounded bg-slate-800 px-1 py-0.5",children:"sample_seconds=30"})," so the backend advances by 30 seconds per tick (30x speed)."]})]})}},46068:function(e,t,n){"use strict";n.d(t,{ToastProvider:function(){return l},p:function(){return o}});var r=n(57437),s=n(2265),a=n(44839);let i=(0,s.createContext)(void 0);function l(e){let{children:t}=e,[n,a]=(0,s.useState)([]),l=(0,s.useCallback)(e=>{let t="".concat(Date.now(),"-").concat(Math.random().toString(36).slice(2,8));return a(n=>[...n,{...e,id:t}]),t},[]),o=(0,s.useCallback)(e=>{a(t=>t.filter(t=>t.id!==e))},[]),u=(0,s.useCallback)(()=>a([]),[]),d=(0,s.useMemo)(()=>({toasts:n,push:l,dismiss:o,clear:u}),[n,l,o,u]);return(0,r.jsxs)(i.Provider,{value:d,children:[t,(0,r.jsx)(c,{toasts:n,onDismiss:o})]})}function o(){let e=(0,s.useContext)(i);if(!e)throw Error("useToast must be used within a ToastProvider");return e}function c(e){let{toasts:t,onDismiss:n}=e;return(0,r.jsx)("div",{className:"pointer-events-none fixed inset-x-0 top-4 z-50 flex flex-col items-end gap-3 px-4 sm:items-end sm:px-6",children:t.map(e=>(0,r.jsx)(u,{toast:e,onDismiss:n},e.id))})}function u(e){var t,n;let{toast:s,onDismiss:i}=e,l=null!==(t=s.variant)&&void 0!==t?t:"default";return(0,r.jsx)("div",{className:(0,a.Z)("pointer-events-auto w-full max-w-sm rounded-lg px-4 py-3 shadow-lg ring-1 ring-black/20 backdrop-blur","success"===l?"bg-emerald-500/90 text-white":"error"===l?"bg-red-500/90 text-white":"warning"===l?"bg-amber-500/90 text-black":"bg-slate-800/90 text-white"),role:"status",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,r.jsx)("p",{className:"text-sm font-semibold leading-tight",children:s.title}),s.description?(0,r.jsx)("p",{className:"text-xs leading-tight",children:s.description}):null,s.action?(0,r.jsx)("button",{type:"button",onClick:()=>{var e;null===(e=s.action)||void 0===e||e.onClick(),i(s.id)},className:"mt-2 inline-flex rounded-md border border-white/30 px-2 py-1 text-xs font-semibold text-white transition hover:border-white hover:bg-white/10",children:s.action.label}):null]}),(null===(n=s.dismissible)||void 0===n||n)&&(0,r.jsx)("button",{type:"button",onClick:()=>i(s.id),className:"-m-1 rounded-md p-1 text-xs opacity-70 transition hover:opacity-100","aria-label":"Dismiss notification",children:"✕"})]})})}},8374:function(e,t,n){"use strict";n.d(t,{$T:function(){return x},Dr:function(){return d},HM:function(){return p},Oz:function(){return h},Qu:function(){return v},tQ:function(){return b},w:function(){return g},wC:function(){return f},wE:function(){return m}});var r=n(20357);let s="eems.apiKeyOverride",a=[{name:"NEXT_PUBLIC_BACKEND_TOKEN",value:"01121000099"},{name:"NEXT_PUBLIC_BACKEND_WRITE_TOKEN",value:r.env.NEXT_PUBLIC_BACKEND_WRITE_TOKEN},{name:"NEXT_PUBLIC_BACKEND_KEY",value:r.env.NEXT_PUBLIC_BACKEND_KEY},{name:"NEXT_PUBLIC_BACKEND_API_KEY",value:r.env.NEXT_PUBLIC_BACKEND_API_KEY}],i=null,l=!1,o=!1;function c(){if(!l){l=!0;try{let e=window.localStorage.getItem(s);e&&(i=e,o=!0)}catch(e){}}}function u(){for(let e of a)if(e.value)return{name:e.name,value:e.value};return null}function d(){var e,t;return null!==(t=null===(e=u())||void 0===e?void 0:e.value)&&void 0!==t?t:""}function m(){var e,t;return null!==(t=null===(e=u())||void 0===e?void 0:e.name)&&void 0!==t?t:null}function x(){return c(),i}function f(){return c(),o&&!!i}function h(e,t){i=e.trim()||null,o=!!((null==t?void 0:t.persist)&&i);try{o&&i?window.localStorage.setItem(s,i):window.localStorage.removeItem(s)}catch(e){}}function p(){i=null,o=!1;try{window.localStorage.removeItem(s)}catch(e){}}function g(){return x()||d()}function v(){return g().length>0}function b(){return d().length>0}},92800:function(e,t,n){"use strict";n.d(t,{Bj:function(){return f},CT:function(){return s},LK:function(){return x},M8:function(){return b},Mf:function(){return h},QY:function(){return v},b0:function(){return m},ji:function(){return p},lA:function(){return g}});var r=n(8374);let s="/api/bridge",a=new Set([429,500,502,503,504]);class i extends Error{constructor(e,t,n,r){super(e),this.status=t,this.code=n,this.details=r}}function l(e){if(!s)throw new i("Backend base URL is not configured.",0);return e.startsWith("http")?e:"".concat(s).concat(e)}async function o(e){let t=await e.text();if(t)try{return JSON.parse(t)}catch(t){throw new i("Invalid JSON response: ".concat(t.message),e.status)}}async function c(e){var t,n,r,s,a,l;let o;try{o=await e.clone().json()}catch(e){}if(!o)try{let t=await e.text();if(t)return new i(t,e.status)}catch(e){}let c=null!==(l=null!==(a=null!==(s=null==o?void 0:null===(t=o.error)||void 0===t?void 0:t.message)&&void 0!==s?s:null==o?void 0:o.message)&&void 0!==a?a:e.statusText)&&void 0!==l?l:"Request failed with status ".concat(e.status),u=null==o?void 0:null===(n=o.error)||void 0===n?void 0:n.code,d=null==o?void 0:null===(r=o.error)||void 0===r?void 0:r.details;if(o&&o.detail){d=o.detail;try{if(Array.isArray(o.detail)){let e=o.detail.map(e=>(null==e?void 0:e.msg)||(null==e?void 0:e.detail)||"Validation error").filter(Boolean);e.length>0&&(c=e.join("; "))}else"string"==typeof o.detail&&(c=o.detail)}catch(e){}}return new i(c,e.status,u,d)}function u(e){return new Promise(t=>setTimeout(t,e))}async function d(e,t){var n,r;let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},d=l(e),m=null!==(n=s.retryDelays)&&void 0!==n?n:[],x=0,f=new Headers(null==t?void 0:t.headers);f.set("Accept","application/json");let h={...t,headers:f};for(;;)try{let e=await fetch(d,h);if(!e.ok){let t=await c(e);if(r=e.status,a.has(r)&&x<m.length){await u(m[x++]);continue}throw t}if(204===e.status)return;return await o(e)}catch(e){if(e instanceof i)throw e;if(x<m.length){await u(m[x++]);continue}throw e}}function m(e){let t=new Headers(null==e?void 0:e.headers);t.set("Content-Type","application/json");let n=(0,r.w)();return n?t.set("x-api-key",n):t.delete("x-api-key"),{...e,headers:t}}async function x(e,t){try{return await d(e,t)}catch(n){if(!(n instanceof i))return await d(e,t,{retryDelays:[500]});throw n}}function f(e){return l(e)}async function h(){var e;let t=await x("/api/v1/simulators");return Array.isArray(t)?t:null!==(e=t.data)&&void 0!==e?e:[]}async function p(e){let t=await d("/api/v1/simulators",m({method:"POST",body:JSON.stringify(e)}),{retryDelays:[500,1500,3500]});return"data"in t?t.data:t}async function g(e){return await x("/api/v1/blocks/latest?simulator_id=".concat(encodeURIComponent(e)))}async function v(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r=await x("/api/v1/blocks/history?simulator_id=".concat(encodeURIComponent(e),"&limit=").concat(n));return Array.isArray(r)?r:null!==(t=r.data)&&void 0!==t?t:[]}async function b(e){await d("/api/v1/readings:ingest",m({method:"POST",body:JSON.stringify(e)}),{retryDelays:[500,1500,3500]})}}},function(e){e.O(0,[770,971,23,744],function(){return e(e.s=71536)}),_N_E=e.O()}]);