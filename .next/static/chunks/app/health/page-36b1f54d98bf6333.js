(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[613],{35660:function(e,t,s){Promise.resolve().then(s.bind(s,43786))},20357:function(e,t,s){"use strict";var a,n;e.exports=(null==(a=s.g.process)?void 0:a.env)&&"object"==typeof(null==(n=s.g.process)?void 0:n.env)?s.g.process:s(88081)},88081:function(e){!function(){var t={229:function(e){var t,s,a,n=e.exports={};function r(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(s){try{return t.call(null,e,0)}catch(s){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(e){t=r}try{s="function"==typeof clearTimeout?clearTimeout:i}catch(e){s=i}}();var l=[],c=!1,d=-1;function u(){c&&a&&(c=!1,a.length?l=a.concat(l):d=-1,l.length&&h())}function h(){if(!c){var e=o(u);c=!0;for(var t=l.length;t;){for(a=l,l=[];++d<t;)a&&a[d].run();d=-1,t=l.length}a=null,c=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===i||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{s(e)}catch(t){try{return s.call(null,e)}catch(t){return s.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function p(){}n.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)t[s-1]=arguments[s];l.push(new m(e,t)),1!==l.length||c||o(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(e){return[]},n.binding=function(e){throw Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw Error("process.chdir is not supported")},n.umask=function(){return 0}}},s={};function a(e){var n=s[e];if(void 0!==n)return n.exports;var r=s[e]={exports:{}},i=!0;try{t[e](r,r.exports,a),i=!1}finally{i&&delete s[e]}return r.exports}a.ab="//";var n=a(229);e.exports=n}()},43786:function(e,t,s){"use strict";s.d(t,{default:function(){return y}});var a=s(57437),n=s(2265),r=s(44839);let i={idle:"bg-slate-800 text-slate-300 ring-1 ring-inset ring-slate-700",running:"bg-amber-500/20 text-amber-200 ring-1 ring-inset ring-amber-400/60",success:"bg-emerald-500/20 text-emerald-200 ring-1 ring-inset ring-emerald-400/70",error:"bg-rose-500/20 text-rose-200 ring-1 ring-inset ring-rose-400/60"};function o(e){let{status:t}=e;return(0,a.jsxs)("span",{className:(0,r.Z)("inline-flex items-center gap-1 rounded-full px-3 py-1 text-xs font-semibold",i[t]),children:[(0,a.jsx)("span",{className:"h-2 w-2 rounded-full bg-current opacity-80"}),function(e){switch(e){case"running":return"Running";case"success":return"Healthy";case"error":return"Issue";default:return"Idle"}}(t)]})}var l=s(89733);function c(e){let{title:t,description:s,status:n,meta:r,body:i,onRun:c,actionLabel:d="Run check",disabled:u}=e;return(0,a.jsxs)("section",{className:"flex flex-col gap-4 rounded-2xl border border-slate-800 bg-slate-900/60 backdrop-blur-sm p-6 shadow-lg hover:shadow-xl transition-shadow duration-300",children:[(0,a.jsxs)("header",{className:"flex flex-wrap items-start justify-between gap-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white",children:t}),(0,a.jsx)("p",{className:"max-w-xl text-sm text-slate-400",children:s})]}),(0,a.jsx)(o,{status:n})]}),r&&(0,a.jsx)("div",{className:"text-xs text-slate-400",children:r}),(0,a.jsx)("div",{className:"flex flex-col gap-4 text-sm text-slate-300",children:i}),c&&(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)(l.z,{variant:"primary",size:"md",onClick:c,disabled:u,children:d})})]})}function d(e){let{entries:t}=e;return 0===t.length?(0,a.jsx)("p",{className:"rounded-lg border border-dashed border-slate-800 bg-slate-900/30 px-4 py-6 text-center text-xs text-slate-500",children:"Run any check to start logging responses."}):(0,a.jsx)("ul",{className:"space-y-3 text-xs",children:t.map(e=>(0,a.jsxs)("li",{className:"rounded-lg border border-slate-800 bg-slate-900/30 p-3 text-left text-slate-300 shadow-inner shadow-slate-950/30",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-[11px] uppercase tracking-widest text-slate-500",children:[(0,a.jsx)("span",{children:e.title}),(0,a.jsx)("span",{children:new Date(e.timestamp).toLocaleTimeString()})]}),(0,a.jsx)("p",{className:"mt-1 text-sm font-medium text-white",children:"success"===e.status?"Success":"Error"}),(0,a.jsx)("pre",{className:"mt-2 max-h-48 overflow-auto whitespace-pre-wrap rounded bg-slate-950/60 p-3 text-[11px] leading-relaxed text-slate-400",children:e.detail})]},e.id))})}var u=s(92800),h=s(8374);let m=["/healthz","/api/v1/health","/"];async function p(e,t){if(!u.CT)return{ok:!1,status:0,durationMs:0,message:"Backend base URL is not configured."};let s=(0,u.Bj)(e),a=Date.now();try{let e;let n=await fetch(s,t),r=Date.now()-a,i="".concat(n.status," ").concat(n.statusText);try{let t=await n.text();e=t,t&&(i="".concat(i,"\n").concat(t))}catch(e){}return{ok:n.ok,status:n.status,durationMs:r,message:i,raw:e}}catch(e){return{ok:!1,status:0,durationMs:Date.now()-a,message:e instanceof Error?e.message:"Request failed"}}}async function x(){for(let e of m){let t=await p(e);if(t.ok)return{...t,message:"Health endpoint responded at ".concat(e,".\n").concat(t.message)};if(404!==t.status&&405!==t.status)return{...t,message:"Health check failed at ".concat(e,".\n").concat(t.message)}}return{ok:!1,status:404,durationMs:0,message:"No health endpoints responded (tried /healthz, /api/v1/health, /)."}}async function f(){if(!(0,h.Qu)())return{ok:!1,status:0,durationMs:0,message:"API key is not configured. Provide one above or set NEXT_PUBLIC_BACKEND_TOKEN (or another supported env) to run the handshake check."};let e={simulator_id:"health-check",mode:"auto",ticks:[{power_kw:1,sample_seconds:15,device_ts:new Date().toISOString()}]},t=await p("/api/v1/readings:ingest",(0,u.b0)({method:"POST",body:JSON.stringify(e)}));return t.ok||401!==t.status?{...t,message:t.ok?"Ingestion endpoint accepted the payload. Review acknowledgement below.":"Handshake request failed.\n".concat(t.message)}:{...t,message:"Handshake request failed: backend rejected the API key. Double-check the value provided above or the NEXT_PUBLIC_BACKEND_TOKEN environment variable."}}async function g(){let e=Date.now();try{var t;let s=await (0,u.LK)("/api/v1/simulators"),a=Date.now()-e,n=Array.isArray(s)?s:null!==(t=s.data)&&void 0!==t?t:[];return{ok:!0,status:200,durationMs:a,message:n.length?"Fetched ".concat(n.length," simulator(s)."):"Simulator list responded successfully but returned no items.",raw:JSON.stringify(n,null,2)}}catch(s){let t=Date.now()-e;return{ok:!1,status:s instanceof Error&&"status"in s?Number(s.status):0,durationMs:t,message:s instanceof Error?s.message:"Simulator read failed"}}}var v=s(77209);let b={backend:{status:"idle"},handshake:{status:"idle"},simulatorRead:{status:"idle"}};function y(){var e,t,s;let[r,i]=(0,n.useState)(b),[o,u]=(0,n.useState)([]),m=(0,n.useMemo)(()=>"https://eems-v2-backend-production.up.railway.app",[]),p=m.length>0,y=(0,n.useMemo)(()=>(0,h.Dr)(),[]),k=(0,h.tQ)(),w=(0,n.useMemo)(()=>(0,h.wE)(),[]),[j,N]=(0,n.useState)(""),[T,E]=(0,n.useState)(!1),[R,I]=(0,n.useState)(!1),[S,A]=(0,n.useState)("");(0,n.useEffect)(()=>{let e=(0,h.$T)();e?(N(e),I(!0),E((0,h.wC)())):(N(y),I(!1),E(!1)),A((0,h.w)())},[y]);let C=R?T?"Using manual override (saved locally)":"Using manual override":k?"Using ".concat(null!=w?w:"environment API key"):"API key not configured",L=async e=>{i(t=>({...t,[e]:{...t[e],status:"running",message:void 0}}));try{let t="backend"===e?await x():"handshake"===e?await f():await g();i(s=>({...s,[e]:{status:t.ok?"success":"error",duration:t.durationMs,message:t.message}})),u(s=>{var a;return[{id:"".concat(e,"-").concat(Date.now()),title:"".concat(e," check"),status:t.ok?"success":"error",detail:null!==(a=t.raw)&&void 0!==a?a:t.message,timestamp:new Date().toISOString()},...s]})}catch(s){let t=s instanceof Error?s.message:"Unknown failure";i(s=>({...s,[e]:{status:"error",message:t}})),u(s=>[{id:"".concat(e,"-").concat(Date.now()),title:"".concat(e," check"),status:"error",detail:t,timestamp:new Date().toISOString()},...s])}};return(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-[2fr,1fr] animate-fadeIn",children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("header",{className:"space-y-3",children:[(0,a.jsx)("h1",{children:"Communication Health Checks"}),(0,a.jsx)("p",{className:"text-sm sm:text-base text-slate-400",children:"Run quick diagnostics to verify if the frontend can reach the backend services. These checks will automatically attach prototype headers and surface full responses for debugging."}),(0,a.jsxs)("div",{className:"space-y-4 rounded-xl border border-slate-800 bg-slate-900/50 p-4 text-xs text-slate-400",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-semibold text-slate-200",children:"Backend base URL:"})," ",p?m:"Not configured"]}),(0,a.jsxs)("p",{className:"mt-1",children:[(0,a.jsx)("span",{className:"font-semibold text-slate-200",children:"API key:"})," ",S?"Configured":"Missing"]}),(0,a.jsx)("p",{className:"mt-1 text-[11px] uppercase tracking-[0.2em] text-slate-500",children:C})]}),(0,a.jsxs)("div",{className:"space-y-2 text-slate-300",children:[(0,a.jsx)("label",{className:"block text-xs font-semibold text-slate-200",htmlFor:"health-api-key",children:"Manual API key override"}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row",children:[(0,a.jsx)(v.II,{id:"health-api-key",type:"password",value:j,onChange:e=>N(e.target.value),className:"flex-1",placeholder:"Paste prototype API key"}),(0,a.jsx)(l.z,{variant:"primary",size:"md",onClick:()=>{(0,h.Oz)(j,{persist:T});let e=j.trim().length>0;I(e),E(!!e&&(0,h.wC)()),A((0,h.w)())},className:"w-full sm:w-auto",children:"Apply key"})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-3 text-[11px] text-slate-400",children:[(0,a.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-700 bg-slate-900 text-primary focus:ring-primary",checked:T,onChange:e=>E(e.target.checked)}),"Remember on this device"]}),R&&(0,a.jsx)(l.z,{variant:"ghost",size:"sm",onClick:()=>{(0,h.HM)(),I(!1),E(!1),N(y),A((0,h.w)())},className:"text-xs p-0 h-auto text-slate-300 hover:text-white hover:bg-transparent hover:underline",children:"Clear override"}),(0,a.jsx)("span",{className:"text-slate-500",children:"Useful when Railway rewrites environment variables with “API” into secret references."})]})]})]})]}),(0,a.jsx)(c,{title:"API availability",description:"Calls the health endpoint to ensure the backend server is reachable and responding.",status:r.backend.status,meta:r.backend.duration&&(0,a.jsxs)("span",{children:["Latest response time: ",(0,a.jsxs)("strong",{children:[r.backend.duration.toFixed(0),"ms"]})]}),body:(0,a.jsx)("p",{className:"text-sm text-slate-300",children:null!==(e=r.backend.message)&&void 0!==e?e:"No response logged yet."}),onRun:()=>L("backend"),disabled:!p||"running"===r.backend.status}),(0,a.jsx)(c,{title:"Simulator handshake",description:"Sends a prototype handshake payload to validate the simulator ingestion endpoint and API key authentication.",status:r.handshake.status,meta:r.handshake.duration&&(0,a.jsxs)("span",{children:["Latest response time: ",(0,a.jsxs)("strong",{children:[r.handshake.duration.toFixed(0),"ms"]})]}),body:(0,a.jsx)("p",{className:"text-sm text-slate-300",children:null!==(t=r.handshake.message)&&void 0!==t?t:"No response logged yet."}),onRun:()=>L("handshake"),disabled:!p||"running"===r.handshake.status,actionLabel:"Send handshake"}),(0,a.jsx)(c,{title:"Read API sample",description:"Fetches a small simulator list to confirm read endpoints return data correctly.",status:r.simulatorRead.status,meta:r.simulatorRead.duration&&(0,a.jsxs)("span",{children:["Latest response time: ",(0,a.jsxs)("strong",{children:[r.simulatorRead.duration.toFixed(0),"ms"]})]}),body:(0,a.jsx)("p",{className:"text-sm text-slate-300",children:null!==(s=r.simulatorRead.message)&&void 0!==s?s:"No response logged yet."}),onRun:()=>L("simulatorRead"),disabled:!p||"running"===r.simulatorRead.status,actionLabel:"Fetch simulators"})]}),(0,a.jsxs)("aside",{className:"space-y-3",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Response log"}),(0,a.jsx)(d,{entries:o})]})]})}},11853:function(e,t,s){"use strict";var a=s(2265);let n=a.forwardRef(function(e,t){let{title:s,titleId:n,...r}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},r),s?a.createElement("title",{id:n},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))});t.Z=n},44839:function(e,t,s){"use strict";t.Z=function(){for(var e,t,s=0,a="",n=arguments.length;s<n;s++)(e=arguments[s])&&(t=function e(t){var s,a,n="";if("string"==typeof t||"number"==typeof t)n+=t;else if("object"==typeof t){if(Array.isArray(t)){var r=t.length;for(s=0;s<r;s++)t[s]&&(a=e(t[s]))&&(n&&(n+=" "),n+=a)}else for(a in t)t[a]&&(n&&(n+=" "),n+=a)}return n}(e))&&(a&&(a+=" "),a+=t);return a}}},function(e){e.O(0,[836,971,23,744],function(){return e(e.s=35660)}),_N_E=e.O()}]);